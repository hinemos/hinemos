リリースバージョン:7.0.0
リリース日:2022/3/1

■新規機能

Hinemos ver.7.0.0で追加された新規機能は以下の通りです。

〇監視
  #11348 SDML(Software Defined Monitoring and Logging)＜プレビュー＞
    HinemosLoggingをアプリケーションに組込み、制御ログと監視ログを介在しモニタリング（監視）とロギングの定義と制御を実現します。

〇エンタープライズ
  #11519 RPA管理＜プレビュー＞
    WinActorの導入端末数の増大と適用範囲の拡大、他のRPAツール並行導入により肥大化した運用管理のコストをHinemosが大きく削減します。
    WinActorの他にUiPathに対応します。

〇ユーティリティツール
  #13115 Grafanaプラグイン
    Hinemosの履歴情報をGrafanaで表示するデータソースプラグインを提供します。

■機能改善

Hinemos ver.7.0.0で改善された機能は以下の通りです。

○クライアント・エージェント

#11218 フィルタ条件保存
  日々の運用で使用する履歴ビューのフィルタ条件を複数のAND・ORで指定かつ、保存する事が可能になります。

#12671 エージェントヘルスチェック
  Hinemosマネージャに加えてHinemosエージェントにおいても自身を監視します。

#10237 オペレーションログへのログインセッションと操作を紐づけた記録
  複数のユーザが同じユーザIDで接続している場合の操作を区別できるようにします。

#12483 Windows版Hinemosエージェントのインストーラ改善
  Hinemosエージェントインストール後に実施が必要な手順をHineomsエージェントのインストーラ内で実施するようにします。

〇リポジトリ

#11519 ノード情報にクラウド・仮想化管理の項目追加
  ・「クラウド・仮想化管理 - クラウドログ優先度」
 
#12342 ノード情報にRPA管理の項目追加
  ・「RPAツール情報 - ログ出力ディレクトリ」
  ・「RPA管理ツール情報 - RPA管理ツールタイプ」
  ・「RPA管理ツール情報 - RPAリソースID」
  ・「RPA管理ツール情報 - ユーザ名」
  ・「RPA管理ツール情報 - RPA実行環境ID」

#12729 DHCPサポート機能
 固定IPでないノードにエージェントをインストールすることで、ノードのIPアド レスを自動的に更新します。

#12729 エージェント設定によるスコープ自動割当て
 エージェントに設定を行うことで任意のスコープへ自動的に割当てを行います。

#11479 構成情報取得設定 ユーザ任意情報コマンド動作モード(repository.cmdb.command.mode) "auto"の場合の動作変更
  Windows版エージェントにおいて、ユーザ任意情報コマンド動作モード"auto"の場合の動作が"windows.cmd"に変更となりました。

  上記の変更により、コマンドの実行結果がコマンドプロンプトで実行した場合と同じ結果となるように修正されました。
  ・コマンド内に「"」が奇数個含まれている場合
    例:コマンド「CMD /C echo "abcde" """」を実行した場合の出力

  ・分割したコマンド引数に、空白を含み、かつ全体が「"」で囲まれていない引数がある場合
    例:コマンド「CMD /C echo abc" de "」を実行した場合の出力(第4引数「abc" de "」が該当)

  ・「CMD /C」で実行するコマンドが「"」で入れ子になっている場合
    例:コマンド「CMD /C "echo "ab cde""」を実行した場合の出力

  ・「CMD /C」から実行した「echo」コマンドの各引数の間に、2個以上の空白文字がある場合
    例:コマンド「CMD /C echo "abc"    "def"」を実行した場合の出力("abc"と"def"の間に4個の空白文字)

  また、上記の変更により、以下の両方に一致する場合の動作が変更となります。
  ・コマンドを「CMD /C」経由で実行している。
  ・「>」という文字列をエスケープし、指定している。
    例．コマンドが「CMD /C "echo ^>"」の場合
      6.2 "auto"の実行結果： 「>」
      7.0 "auto"の実行結果：シンタックスエラー

  上記を回避するためには以下のいずれかを実施してください。
  ・Windows版エージェントAgent.propertyのrepository.cmdb.command.modeを"windows"に変更する。
  ・構成情報取得設定のユーザ任意情報 コマンドを「CMD /C」を使用しない形に修正する。
    例の場合「echo ^>」

〇通知

#11692 REST通知
  RESTメッセージによる通知が可能になります。

#11611 通知結果にIDを追加
  イベント通知やメール通知など、各種通知において同一の情報を元にしているかを判断する共通のIDを付与します。

#11479 イベントカスタムコマンド コマンドの実行モード(monitor.event.customcmd.cmdN.mode) "auto"の場合の動作変更
  Windows版マネージャにおいて、コマンドの実行モードが"auto"の場合の動作が"windows.cmd"に変更となりました。

  上記の変更により、コマンドの実行結果がコマンドプロンプトで実行した場合と同じ結果となるように修正されました。
  ・コマンド内に「"」が奇数個含まれている場合
    例:コマンド「CMD /C echo "abcde" """」を実行した場合の出力

  ・分割したコマンド引数に、空白を含み、かつ全体が「"」で囲まれていない引数がある場合
    例:コマンド「CMD /C echo abc" de "」を実行した場合の出力(第4引数「abc" de "」が該当)

  ・「CMD /C」で実行するコマンドが「"」で入れ子になっている場合
    例:コマンド「CMD /C "echo "ab cde""」を実行した場合の出力

  ・「CMD /C」から実行した「echo」コマンドの各引数の間に、2個以上の空白文字がある場合
    例:コマンド「CMD /C echo "abc"    "def"」を実行した場合の出力("abc"と"def"の間に4個の空白文字)

  また、上記の変更により、以下の両方に一致する場合の動作が変更となります。
  ・コマンドを「CMD /C」経由で実行している。
  ・「>」という文字列をエスケープし、指定している。
    例．起動コマンドが「CMD /C "echo >"」の場合
      6.2 "auto"の実行結果： 「>」
      7.0 "auto"の実行結果：シンタックスエラー

  上記を回避するためには以下のいずれかを実施してください。
  ・Wndows版マネージャ Hinemosプロパティのmonitor.event.customcmd.cmdN.modeを"windows"に変更する。
  ・イベントカスタムコマンドのコマンド(Hinesmosプロパティmonitor.event.customcmd.cmdN.command )を「CMD /C」を使用しない形に修正する。
    上述の例の場合「echo ^>」

〇メンテナンス

#12256 履歴削除にメンテナンス種別に「ジョブ連携メッセージ削除」追加

#11519 履歴削除にメンテナンス種別に「RPAシナリオ 実績削除」追加

#11319 Hinemosに登録されているデータをファイル出力するスクリプト追加
  メンテナンススクリプトに以下のデータをファイルへ出力するスクリプト(hinemos_export.sh)が追加されます。
    ・イベント履歴
    ・ステータス履歴
    ・ジョブ実行履歴
    ・収集データ

〇セルフチェック

#10151 HinemosエージェントのINTERNALイベントをSyslog送信に対応
  HinemosエージェントのINTERNALイベントをSyslogで外部に送信します。

#7227 マネージャで生じたINTERNALイベントのメール送信件名を変更できるよう改善
  INTERNALイベントのメール送信件名に任意の文字列を指定できるようになります。

〇監視

#12427 ログ件数監視の仕様改善
  監視対象の範囲が「前回の監視タイミング以降」から「最後に発生したログから監視間隔遡った期間」に変更になり、前回の監視タイミング前後で発生したログも監視が可能になります。

#12774 カスタムトラップ監視のMC機能対応
  カスタムトラップ監視をsyslogおよびsnmptrapと同様にMC機能の一時受信機構に対応します。

#11714 文字列系監視の重要度変化に対する仕様改善
  文字列系監視について、各監視設定で以下項目が設定可能になります。
    ・監視に対する重要度の管理単位をパターンマッチ毎あるいは監視設定全体で行うか 
    ・不明についてパターン不一致と取得失敗を分けて重要度変化の管理を行うか

#12758 クラウドサービス監視の重要度変化に対する仕様改善
  クラウドサービス監視で以下項目が設定可能になります。
    ・不明についてパターン不一致と取得失敗を分けて重要度変化の管理を行うか

#11519 ログファイル監視 ディレクトリのノードプロパティ対応
  ログファイル監視のディレクトリにノードプロパティが使用できるようになりました。

#11479 カスタム監視 カスタム監視のコマンド動作に関するOSプラットフォーム定義(monitor.custom.command.mode) "auto"の場合の動作変更
  Windows版エージェントにおいて、コマンド動作に関するOSプラットフォーム定義"auto"の場合の動作が"windows.cmd"に変更となりました。

  上記の変更により、コマンドの実行結果がコマンドプロンプトで実行した場合と同じ結果となるように修正されました。
  ・コマンド内に「"」が奇数個含まれている場合
    例:コマンド「CMD /C echo "abcde" """」を実行した場合の出力

  ・分割したコマンド引数に、空白を含み、かつ全体が「"」で囲まれていない引数がある場合
    例:コマンド「CMD /C echo abc" de "」を実行した場合の出力(第4引数「abc" de "」が該当)

  ・「CMD /C」で実行するコマンドが「"」で入れ子になっている場合
    例:コマンド「CMD /C "echo "ab cde""」を実行した場合の出力

  ・「CMD /C」から実行した「echo」コマンドの各引数の間に、2個以上の空白文字がある場合
    例:コマンド「CMD /C echo "abc"    "def"」を実行した場合の出力("abc"と"def"の間に4個の空白文字)

  また、上記の変更により、以下の両方に一致する場合の動作が変更となります。
  ・コマンドを「CMD /C」経由で実行している。
  ・「>」という文字列をエスケープし、指定している。
    例．起動コマンドが「CMD /C "echo >"」の場合
      6.2 "auto"の実行結果： 「>」
      7.0 "auto"の実行結果：シンタックスエラー

  上記を回避するためには以下のいずれかを実施してください。
  ・Windows版エージェントAgent.propertyのmonitor.custom.command.modeを"windows"に変更
  ・カスタム監視のコマンドを「CMD /C」を使用しない形に修正する。
    上述の例の場合「echo ^>」

#12149 HTTP監視(シナリオ)がリダイレクトに対応

#11524 Windowsサービス監視で使用するWinRMの認証方法にNTLM認証を追加

〇ジョブ

#11318 ジョブセッション事前生成
  ジョブセッションの事前生成によりジョブ定義変更の反映タイミングの制御やスケジュールの見える化と実行時の負荷分散を実現します。

#12256 ジョブ連携メッセージ
  ジョブ連携メッセージを介してマネージャ間を跨るジョブ実行制御が可能になります。

#12487 ファイルチェックジョブ
  ファイルの存在有無・作成・変更・削除を契機に後続のジョブを実行する、ファイルチェックジョブを追加します。

#12488 標準出力のファイル出力
  実行したコマンドの標準出力・標準エラー出力をジョブ履歴として管理する以外にファイル出力が可能になります。

#12639 戻り値の飛び番対応
  先行ジョブの戻り値に対して、飛び番の戻り値で判定が可能になります。

#12486 複数待ち条件対応
  複数の待ち条件をAND/ORで組み合わせた待ち条件が指定可能になります。

#12486 待ち条件の判定ロジック修正
  ver.6.2以前のHinemosでは待ち条件にジョブの終了値か終了状態が含まれていた場合は組み合わせ条件によって待ち条件判定が可能な状態であっても待ち条件に設定されているジョブの終了を待っておりましたが、ver.7.0.0では待たなくなるように統一します。
  AND条件の場合、何れかの待ち条件が1つでもFALSEになった時点で条件未達と判断されます。
  OR条件の場合、何れかの待ち条件が1つでもTRUEになった時点で条件達成と判断されます。

#12606 繰り返し実行
  ジョブが異常終了した際のリトライ（繰り返し実行）や、単純な繰り返し実行において任意の間隔で指定可能になります。

#11479 コマンドジョブ 起動コマンド動作モード(job.command.mode) "auto"の場合の動作変更
  Windows版エージェントにおいて、起動コマンド動作モード"auto"の場合の動作が"windows.cmd"に変更となりました。

  上記の変更により、コマンドの実行結果がコマンドプロンプトで実行した場合と同じ結果となるように修正されました。
  ・コマンド内に「"」が奇数個含まれている場合
    例:コマンド「CMD /C echo "abcde" """」を実行した場合の出力

  ・分割したコマンド引数に、空白を含み、かつ全体が「"」で囲まれていない引数がある場合
    例:コマンド「CMD /C echo abc" de "」を実行した場合の出力(第4引数「abc" de "」が該当)

  ・「CMD /C」で実行するコマンドが「"」で入れ子になっている場合
    例:コマンド「CMD /C "echo "ab cde""」を実行した場合の出力

  ・「CMD /C」から実行した「echo」コマンドの各引数の間に、2個以上の空白文字がある場合
    例:コマンド「CMD /C echo "abc"    "def"」を実行した場合の出力("abc"と"def"の間に4個の空白文字)

  また、上記の変更により、以下の両方に一致する場合の動作が変更となります。
  ・コマンドを「CMD /C」経由で実行している。
  ・「>」という文字列をエスケープし、指定している。
    例．コマンドが「CMD /C "echo ^>"」の場合
      6.2 "auto"の実行結果： 「>」
      7.0 "auto"の実行結果：シンタックスエラー

  上記を回避するためには以下のいずれかを実施してください。
  ・Windows版エージェントAgent.propertyのjob.command.modeを"windows"に変更する。
  ・コマンドジョブの起動コマンド、停止コマンドを「CMD /C」を使用しない形に修正する。
    上述の例の場合「echo ^>」

〇クラウド管理

#12342 クラウドログ監視
  AWS/Azureのログサービス上に存在するログの監視・収集をシームレスに実現します。

#12482 クラウド通知
  通知のバリエーションとしてAmazon EventbridgeとAzure Eventgridに対応します。

#12395 クラウドリソース制御ジョブのMC対応
  クラウドVM管理機能のリソース制御を行うジョブをMC上でマスタ・スタンバイを意識せず実行が可能になります。

#12130 ノードの管理対象フラグがコンピュートの操作に応じて変更されるよう改善
  Hinemosからコンピュートを起動・停止した場合、コンピュートに該当するノードの管理対象フラグが起動時にチェックされ、停止時にチェックが解除されるようになります。

〇ノードマップ

#11507 構成情報ダウンロードの内容にファシリティ名を追加

〇その他改善

#11226 メール送信に使用するSMTPサーバを複数登録できるよう改善
  以下で使用するSMTPサーバーを複数指定できるようになります。
    ・メール通知
    ・レポーティング機能
    ・承認ジョブ

#13144 メール送信の認証方法にOAuth2.0を追加
  以下で使用するSMTPサーバーの認証にOAuth2.0が使用できるようになります。
    ・メール通知
    ・レポーティング機能
    ・承認ジョブ

■仕様変更

Hinemos ver.7.0.0の仕様変更は以下の通りです。

〇アーキテクチャ

#12395 Hinemos内部DBに関する改善
  Hinemos内部DBにPostgreSQL 12を採用し、Linux版/Windows版マネージャを共通のアーキテクチャでシングル・ミッションクリティカル構成を実現します。

#12395 REST API
  Hinemosの全APIをSOAPからRESTへ全面移行し、各種サービス・ソリューションとの連携を簡易に実現します。

〇インポート・エクスポート

#11321 バルクインポート対応
  設定インポート時の機能単位での一括インポートに対応します。

〇メンテナンス

#11321 ジョブ実行履歴削除の削除処理の方式を変更
  ジョブ実行履歴削除の削除処理を一度のトランザクションで削除していた処理を日毎にデータを分割して複数回のトランザクションで削除するよう変更されます。

■その他

- エージェント互換性
  Hinemos ver.7.0のマネージャとHinemos ver.6.xのエージェントは互換性があり、各バージョンのエージェントが提供している機能に制限はございません。
  なお、Hinemos ver.6.xのエージェントは、Hinemos ver.7.0の新規能は動作対象外となります。

- プレビュー
  SDML、RPA管理機能は、ver.7.0.0ではプレビュー版です。
